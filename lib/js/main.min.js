function searchGIF(a,b){lastQuery=a;var c=encodeURI(a),d="http://api.giphy.com/v1/gifs/search?q="+c+"&limit="+resultsLimit+"&offset="+b+"&api_key=dc6zaTOxFJmzC",e=$.ajax({url:d,method:"GET"});e.then(function(a){console.log(a),moreButtonExists===!1&&(createMoreButtonTemplate(),moreButtonExists=!0),moreButtonExists===!0&&$(".more-button").html("MORE "+lastQuery.toUpperCase());var b=a.data;console.log(b);var c="fixed_height_small";for(var d in b)createGifTemplate(createGifContext(b[d],c))}).fail(function(a){console.log("MAJOR BUMMER: "+a)})}function createGifContext(a,b){return{gif_url:a.images[b].url}}function createGifTemplate(a){var b=$("#gif").html(),c=Handlebars.compile(b),d=a,e=c(d);$(e).fadeIn("slow").prependTo(".content")}function createMoreButtonTemplate(){var a={button_text:"GET MORE "+lastQuery.toUpperCase()},b=$("#more-gifs").html(),c=Handlebars.compile(b),d=a,e=c(d);$(e).fadeIn("slow").prependTo("main")}function createPage(a,b){var c=$(a).html(),d=Handlebars.compile(c),e=b,f=d(e);$(f).slideDown("slow",function(){$(this).appendTo("main")})}var lastQuery=null,alreadySeen=0,resultsLimit=null,gifContentPageCreated=!1,moreButtonExists=!1;$("main").on("click",".delete_button",function(a){$(this).parents(".gif-container").remove()}),$(".search-form").on("click",".search-button",function(a){a.preventDefault();var b=$(".search-field").val();$(".search-field").val(""),$(".landing-container").remove(),alreadySeen>0&&(alreadySeen=0),gifContentPageCreated===!1&&(createPage("#gifContentPage","testing testing"),gifContentPageCreated=!0),resultsLimit=4,searchGIF(b,alreadySeen),alreadySeen+=resultsLimit}),$("main").on("click",".clear-button",function(a){$(".gif-container").remove(),$(".more-button-container").remove(),alreadySeen=0,lastQuery=null,moreButtonExists=!1}),$("main").on("click",".more-button",function(a){resultsLimit=2,searchGIF(lastQuery,alreadySeen),alreadySeen+=resultsLimit,console.log(alreadySeen+" gifs have already been seen for query: '"+lastQuery+"'")}),$(window).on("load",function(a){pageContext={},createPage("#landing",pageContext)}),$("main").on("click",".start-button",function(a){$(".landing-container").remove(),createPage("#gifContentPage","testing testing"),gifContentPageCreated=!0});