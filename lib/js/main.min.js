function searchGIF(a,b){$("#loading-container").removeClass("hidden"),lastQuery=a;var c=encodeURI(a),d="http://api.giphy.com/v1/gifs/search?q="+c+"&limit="+resultsLimit+"&offset="+b+"&api_key=dc6zaTOxFJmzC",e=$.ajax({url:d,method:"GET"});e.then(function(a){$("#loading-container").addClass("hidden"),moreButtonExists===!1&&(createMoreButtonTemplate(),moreButtonExists=!0),moreButtonExists===!0&&$(".more-button").html("more "+lastQuery.toLowerCase());var b=a.data,c="fixed_height_small";for(var d in b)createGifTemplate(createGifContext(b[d],c))}).fail(function(a){console.log(a),$("#loading-container").addClass("hidden");var b=$("<h3>",{class:"error-title"}).text("Oops! An error occurred!"),c=$("<div>",{id:"error-div",class:"error-container"}).append(b);$("main").append(c)})}function createGifContext(a,b){return{gif_url:a.images[b].url}}function createGifTemplate(a){var b=$("#gif").html(),c=Handlebars.compile(b),d=a,e=c(d);$(e).fadeIn("slow").prependTo(".content")}function createMoreButtonTemplate(){var a={button_text:"more "+lastQuery.toLowerCase()},b=$("#more-gifs").html(),c=Handlebars.compile(b),d=a,e=c(d);$(e).prependTo("main")}function createPage(a){var b=$(a).html(),c=Handlebars.compile(b),d={},e=c(d);$(e).appendTo("main")}var lastQuery=null,alreadySeen=0,resultsLimit=null,gifContentPageCreated=!1,moreButtonExists=!1;$("main").on("click",".delete_button",function(a){$(this).parents(".gif-container").remove()}),$(".navigation").on("submit",".search-form",function(a){a.preventDefault();var b=$(".search-field").val();$(".search-field").val(""),$(".landing-container").remove(),alreadySeen>0&&(alreadySeen=0),gifContentPageCreated===!1&&(createPage("#gifContentPage"),gifContentPageCreated=!0),resultsLimit=6,searchGIF(b,alreadySeen),alreadySeen+=resultsLimit}),$("main").on("click",".clear-button",function(a){$(".gif-container").remove(),$(".more-button-container").remove(),alreadySeen=0,lastQuery=null,moreButtonExists=!1}),$("main").on("click",".more-button",function(a){resultsLimit=2,searchGIF(lastQuery,alreadySeen),alreadySeen+=resultsLimit}),$(window).on("load",function(a){pageContext={},createPage("#landing",pageContext)}),$("main").on("click","#error-div",function(a){$("#error-div").remove(),alreadySeen=0,lastQuery=null,moreButtonExists=!1});